# misezan_api
- 2023年M-1グランプリ決勝での "さや香" のネタである「見せ算」を行うAPIとして動作します
- Scalaを使ったAPIの練習として実装
- 人によって要件が変わる曖昧さが面白い

## 決勝ネタからみる見せ算とその要件

### 決勝ネタ中での説明
- 四則演算に追加すべき五則目の演算
- 数字と数字を見せあわせてどう思うかというもの
- 演算子の名称は"見せ" 
- 答えの名称は"眼"

#### 基本ルール１
同じ数字同士を"見せ"した場合、その"眼"は`0`となる（自分と同じ数字を見たら恥ずかしくてお互い立ち去るため、何も残らない）
#### 基本ルール２
違う数字を同士を"見せ"した場合、その"眼"は大きい方の数字となる（小さい数字が大きい数字を見たら怖くて立ち去るため、大きい数字が残る）
#### 応用ルール
- 「6"見せ"9」の場合、その眼は`11`となる（数字がお互いに気になって近づいていくため11になる。指が11になってるだけだろとツッコまれていた）
- 「2"見せ"5」の場合、その眼は`1.1`となる（デジタル表記で反転しているため、数字がお互いに気になって近づいていく。しかし、近づいた際に流石に違いに気づき、びっくりして5が持っている携帯を落とす。その携帯が地面について、小数点になり`1.1`となる。）
- 「1"見せ"100」の場合、その眼は`83`となる（1が100を見たら、逃げられないと思う。しかし、1が腹をくくって100に突っ込み、頑張って17人倒すため`83`になる。）
  - 83の中に優しい女性が一人いて、倒れている人を介抱したことで二人が恋に落ち、後々結婚、子供が生まれて更に1増えるというのは大学院のレベル

### 要件について
上記内容から、以下を要件とする。
- 演算子の名称は"見せ"とし、演算子は`<*>`とする（`<*>`はなんとなく目っぽいため採用）
- 答えの名称は"眼"
- 同じ数字同士を"見せ"した場合、その"眼"は`0`とする
- 違う数字を同士を "見せ" した場合、その "眼" は大きい方の数字となる（下記の例外を除く）
#### 違う数字を同士を "見せ" した場合の例外
  - 数字として、6もしくは9の両方もしくはいずれかで構成されるかつ桁数が同じ数字同士を"見せ"した場合、その眼は`11`とする
  - 数字として、2もしくは5の両方もしくはいずれかで構成さるかつ桁数が同じ数字同士を"見せ"した場合、その眼は`1.1`とする
  - ”見せ”する数字の一方が、もう一方の100倍以上であった場合、`(大きい方の数字)-(少ない方の数字×17)`を眼とする
#### 大学院のレベルについて
現状のシステムでは、結婚し子供が生まれるのには時間がかかるという理由から、採用しないことにする。

## プロジェクト構成
`src/main/scala/`以下に配置。
- `/MyServer.scala`: WebサーバーとAPIエンドポイントの定義を記述
- `Misezan.scala`: 見せ算を行うクラス定義を記述
- `rules`ディレクトリ: 見せ算の判定を行うためファイルを配置
  - `JudgeRule.scala`: 見せ算の基本ルールに基づく判定に関するクラス定義を記述
  - `AppliedJudgeRule.scala`: 見せ算の応用ルールに基づく判定に関するクラス定義を記述


## 実行環境

- Scala 2.13.3
- Java 17
- sbt 1.9.9

## 実行方法

プロジェクトのルートディレクトリで以下のコマンドを実行します。
```
sbt run
```

サーバーが起動したら、`http://localhost:8080/`にアクセスしてAPIをテストできます。
Enter(return)キーを押すと終了します。

## APIエンドポイント
現状はエンドポイントをオープンにしていない為、実行してローカルで試してください。
- `GET /misazan?arg1=<引数1>&arg2=<引数2>`: 指定された日時と年齢に基づいて、観覧可能日時とその料金の提案を行います。
- コマンドラインからアクセスする際は`curl http://localhost:8080/misazan?arg1=<引数1>&arg2=<引数2>`

今後、json等の形式で結果を返すエンドポイントを追加しようかと考えています。

## 入出力の形式について
### 入力
- <引数1>と<引数2>について、整数を入力の想定とする。
- 現状完璧には対応できていない。

今後、負の数等にも対応する予定。

例えば
引数1：1
引数2：100
の場合、
`curl http://localhost:8080/misezan?arg1=1&arg2=100`
と入力してください。

### 出力
```
眼は83.0です
```

#### エラーハンドリング
追記予定

## 開発者向け情報

### ビルドツール

- sbt: Scalaプロジェクトのビルドに使用します。

### コードフォーマット

プロジェクトのコードフォーマットには`scalafmt`を使用しています。
フォーマットを適用するには、以下のコマンドを実行してください。
```
sbt scalafmtAll
```

### コード解析

`scalafix`を使用してコードの静的解析を行います。
解析を実行するには、以下のコマンドを実行してください。
```
sbt scalafixAll
```

### テスト

`ScalaTest`を使用してコードのテストを行うことができます。
テストを実行するには、以下のコマンドを実行してください。
```
sbt test
```